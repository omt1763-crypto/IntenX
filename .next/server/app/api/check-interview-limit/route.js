"use strict";(()=>{var e={};e.id=6786,e.ids=[6786],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},77971:(e,i,t)=>{t.r(i),t.d(i,{headerHooks:()=>d,originalPathname:()=>_,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>m});var r={};t.r(r),t.d(r,{POST:()=>POST});var s=t(10884),a=t(16132),n=t(95798),o=t(47770);async function POST(e){try{let{userId:i}=await e.json();if(!i)return n.Z.json({success:!1,error:"User ID is required"},{status:400});let{data:t,error:r}=await o.pR.from("user_subscriptions").select("*, subscription_plans(name, interview_limit)").eq("user_id",i).eq("status","active").single(),s="Free Trial",a=2;if(t||r)t&&(s=t.subscription_plans.name,a=t.subscription_plans.interview_limit);else{let{data:e}=await o.pR.from("subscription_plans").select("id").eq("name","Free Trial").single();e&&await o.pR.from("user_subscriptions").insert({user_id:i,plan_id:e.id,status:"active"}).on("*",e=>{console.log("[Check Limit] Auto-created free trial")})}let{count:c}=await o.pR.from("interview_usage").select("id",{count:"exact",head:!0}).eq("user_id",i),u=c||0,l=Math.max(0,a-u),p=u<a;return console.log(`[Check Limit] User: ${i}`),console.log(`  Plan: ${s}`),console.log(`  Interviews Used: ${u}/${a}`),console.log(`  Can Continue: ${p}`),n.Z.json({success:!0,canContinue:p,planName:s,interviewCount:u,interviewLimit:a,remainingInterviews:l,message:p?`${l} interview${1!==l?"s":""} remaining`:"Interview limit reached. Please upgrade your subscription."})}catch(e){return console.error("[Check Limit] Error:",e),n.Z.json({success:!1,error:e.message},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/check-interview-limit/route",pathname:"/api/check-interview-limit",filename:"route",bundlePath:"app/api/check-interview-limit/route"},resolvedPagePath:"C:\\Users\\omt91\\Downloads\\main\\interviewverse_frontend\\app\\api\\check-interview-limit\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:l,serverHooks:p,headerHooks:d,staticGenerationBailout:m}=c,_="/api/check-interview-limit/route"}};var i=require("../../../webpack-runtime.js");i.C(e);var __webpack_exec__=e=>i(i.s=e),t=i.X(0,[729,5798,8617,7770],()=>__webpack_exec__(77971));module.exports=t})();