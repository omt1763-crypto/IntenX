"use strict";(()=>{var e={};e.id=8247,e.ids=[8247],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},85155:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>I,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>u,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>p});var i={};t.r(i),t.d(i,{GET:()=>GET,POST:()=>POST});var s=t(10884),n=t(16132),o=t(95798),a=t(47770);async function POST(e){try{let r=await e.json();if(console.log("[SaveInterview API] Saving interview:",{userId:r.user_id,jobId:r.job_id,applicantId:r.applicant_id,duration:r.duration}),console.log("[SaveInterview API] Full data being saved:",JSON.stringify({job_id:r.job_id,applicant_id:r.applicant_id,user_id:r.user_id,status:r.status,timestamp:r.timestamp},null,2)),!r.user_id)return o.Z.json({error:"Missing required field: user_id"},{status:400});let t={id:r.id,user_id:r.user_id,applicant_id:r.applicant_id||null,job_id:r.job_id||null,interview_type:r.interview_type||"real",title:r.title||"Technical Interview",position:r.position||"Interview",company:r.company||"Unknown",client:r.client||"Unknown",duration:parseInt(r.duration)||0,status:r.status||"completed",timestamp:r.timestamp||new Date().toISOString(),skills:Array.isArray(r.skills)?r.skills:[],conversation:Array.isArray(r.conversation)?r.conversation:[],notes:r.notes||"",created_at:new Date().toISOString()};console.log("[SaveInterview API] Clean data to insert:",JSON.stringify(t,null,2));let{data:i,error:s}=await a.pR.from("interviews").insert([t]).select().single();if(s){if(console.error("[SaveInterview API] Full error object:",JSON.stringify(s,null,2)),console.error("[SaveInterview API] Error message:",s.message),console.error("[SaveInterview API] Error code:",s.code),console.error("[SaveInterview API] Error details:",s.details),s.message&&(s.message.includes("does not exist")||"42P01"===s.code))return console.error("[SaveInterview API] Table does not exist"),o.Z.json({error:"Interviews table not set up. Please run the table creation SQL.",code:"TABLE_MISSING"},{status:503});return o.Z.json({error:s.message||"Failed to save interview",code:s.code,details:s.details||s,fullError:JSON.stringify(s)},{status:400})}if(console.log("[SaveInterview API] Interview saved successfully:",i.id),console.log("[SaveInterview API] Saved interview with job_id:",i.job_id,"applicant_id:",i.applicant_id),t.applicant_id){let{error:e}=await a.pR.from("job_applicants").update({interview_id:i.id,status:"completed"}).eq("id",t.applicant_id);e?console.error("[SaveInterview API] Error updating applicant:",e):console.log("[SaveInterview API] Applicant updated with interview_id:",i.id)}return o.Z.json({success:!0,data:i,message:"Interview saved successfully"})}catch(e){return console.error("[SaveInterview API] Error:",e),o.Z.json({error:e.message||"Internal server error"},{status:500})}}async function GET(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId"),i=r.get("jobId");if(console.log("[GetInterviews API] Request received:",{userId:t,jobId:i}),!t&&!i)return o.Z.json({error:"Missing userId or jobId parameter"},{status:400});let s=a.pR.from("interviews").select("*");t&&(s=s.eq("user_id",t),console.log("[GetInterviews API] Querying by userId:",t)),i&&(s=s.eq("job_id",i),console.log("[GetInterviews API] Querying by jobId:",i));let{data:n,error:l}=await s.order("created_at",{ascending:!1});if(console.log("[GetInterviews API] Supabase query completed"),console.log("[GetInterviews API] Returned rows:",n?.length||0),l)return console.error("[GetInterviews API] Supabase error:",l.message),console.error("[GetInterviews API] Error code:",l.code),o.Z.json({error:l.message||"Failed to fetch interviews",code:l.code},{status:400});return console.log("[GetInterviews API] âœ… Success: returning",n?.length||0,"interviews"),o.Z.json({success:!0,data:n||[],count:n?.length||0})}catch(e){return console.error("[GetInterviews API] Catch block error:",e.message),console.error("[GetInterviews API] Full error:",e),o.Z.json({error:e.message||"Internal server error"},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/interviews/route",pathname:"/api/interviews",filename:"route",bundlePath:"app/api/interviews/route"},resolvedPagePath:"C:\\Users\\omt91\\Downloads\\main\\interviewverse_frontend\\app\\api\\interviews\\route.js",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:u,headerHooks:v,staticGenerationBailout:p}=l,I="/api/interviews/route"}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[729,5798,8617,7770],()=>__webpack_exec__(85155));module.exports=t})();