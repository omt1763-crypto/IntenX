"use strict";(()=>{var e={};e.id=722,e.ids=[722],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},44631:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>g,patchFetch:()=>C,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>I,staticGenerationAsyncStorage:()=>m});var n={};t.r(n),t.d(n,{POST:()=>p});var o=t(49303),r=t(88716),s=t(60670),i=t(87070),d=t(85662),l=t(84770);async function p(e){try{let a=await e.formData(),t=a.get("name"),n=a.get("email"),o=a.get("phone"),r=a.get("position"),s=a.get("jobId"),p=a.get("resume");if(console.log("═".repeat(80)),console.log("[CandidateIntake API] \uD83D\uDCE5 Received candidate form submission"),console.log("[CandidateIntake API] Candidate data:",{name:t||"(empty)",email:n||"(empty)",phone:o||"(empty)",position:r||"(empty)",jobId:s||"(empty)",resumeFileName:p?.name||"none"}),console.log("═".repeat(80)),!t||!n||!o||!r)return console.error("[CandidateIntake API] ❌ Validation failed: Missing required fields"),i.NextResponse.json({error:"Missing required fields"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return console.error("[CandidateIntake API] ❌ Validation failed: Invalid email format"),i.NextResponse.json({error:"Invalid email format"},{status:400});console.log("[CandidateIntake API] ✅ Validation passed, attempting database insert...");let c=(0,l.randomUUID)();console.log("[CandidateIntake] Attempting to insert with data:",{id:c,name:t,email:n,phone:o,position_applied:r,job_id:s,resume_url:p?.name||null,status:"pending",created_at:new Date().toISOString()});let{data:u,error:m}=await d.pR.from("job_applicants").insert([{id:c,name:t,email:n,phone:o,position_applied:r,job_id:s||null,resume_url:p?.name||null,status:"pending",created_at:new Date().toISOString()}]).select().single();if(m){if(console.error("[CandidateIntake] ❌ Database error:",m),console.error("[CandidateIntake] Error code:",m.code),console.error("[CandidateIntake] Error message:",m.message),console.error("[CandidateIntake] Error details:",m.details),"42P01"===m.code||m.message?.includes("does not exist"))return console.error("[CandidateIntake API] ❌ TABLE NOT FOUND - job_applicants table does not exist"),i.NextResponse.json({error:"Database table not set up. Please create the job_applicants table in Supabase."},{status:500});if("42703"===m.code||m.message?.includes("column"))return console.error("[CandidateIntake API] ❌ COLUMN MISMATCH ERROR"),i.NextResponse.json({error:`Column error: ${m.message}. Expected columns: id, name, email, phone, position_applied, job_id, resume_url, status, created_at`},{status:500});return console.error("[CandidateIntake API] ❌ DATABASE ERROR"),console.error("[CandidateIntake API] Error details:",m),i.NextResponse.json({error:m.message||"Failed to save candidate information",details:m.details,code:m.code},{status:500})}return console.log("[CandidateIntake API] ✅ Candidate successfully saved to job_applicants table"),console.log("[CandidateIntake API] Saved record ID:",u?.id),console.log("[CandidateIntake API] Saved data:",{id:u?.id,name:u?.name,email:u?.email,phone:u?.phone,position_applied:u?.position_applied,job_id:u?.job_id,status:u?.status,created_at:u?.created_at}),console.log("═".repeat(80)),i.NextResponse.json({success:!0,message:"Candidate information saved successfully",candidateId:u?.id},{status:201})}catch(e){return console.error("[CandidateIntake API] ❌ UNEXPECTED ERROR"),console.error("[CandidateIntake API] Error details:",e),console.error("[CandidateIntake API] Error type:",typeof e),i.NextResponse.json({error:"Internal server error",details:String(e)},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/candidate-intake/route",pathname:"/api/candidate-intake",filename:"route",bundlePath:"app/api/candidate-intake/route"},resolvedPagePath:"C:\\Users\\omt91\\Downloads\\main\\interviewverse_frontend\\app\\api\\candidate-intake\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:I}=c,g="/api/candidate-intake/route";function C(){return(0,s.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:m})}},85662:(e,a,t)=>{t.d(a,{OQ:()=>i,pR:()=>d});var n=t(76596);let o=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,s=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!o||!r)throw Error("Missing Supabase environment variables");let i=(0,n.eI)(o,r),d=(0,n.eI)(o,s||r)}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),n=a.X(0,[8948,5972,6596],()=>t(44631));module.exports=n})();