"use strict";(()=>{var e={};e.id=5624,e.ids=[5624],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46310:(e,i,t)=>{t.r(i),t.d(i,{originalPathname:()=>m,patchFetch:()=>I,requestAsyncStorage:()=>v,routeModule:()=>c,serverHooks:()=>w,staticGenerationAsyncStorage:()=>u});var n={};t.r(n),t.d(n,{GET:()=>d,dynamic:()=>p});var r=t(49303),a=t(88716),o=t(60670),s=t(87070),l=t(85662);let p="force-dynamic";async function d(e){try{let{searchParams:i}=new URL(e.url),t=i.get("applicantId");if(!t)return s.NextResponse.json({error:"Missing applicantId parameter"},{status:400});console.log("[InterviewDetail API] Fetching interview for applicant:",t);let{data:n,error:r}=await l.pR.from("job_applicants").select("*").eq("id",t).single();r&&console.error("[InterviewDetail API] Error fetching applicant:",r.message);let a=null;if(n?.interview_id){console.log("[InterviewDetail API] Found interview_id in applicant record:",n.interview_id);let e=await l.pR.from("interviews").select("*").eq("id",n.interview_id).single();a=e.data,e.error,a&&console.log("[InterviewDetail API] ✅ Found interview via applicant.interview_id")}if(!a&&t){console.log("[InterviewDetail API] Trying lookup by applicant_id in interviews table");let e=await l.pR.from("interviews").select("*").eq("applicant_id",t).order("created_at",{ascending:!1}).limit(1).single();a=e.data,e.error,a&&console.log("[InterviewDetail API] ✅ Found interview via applicant_id match")}if(!a&&n?.job_id&&(console.log("[InterviewDetail API] Trying to find interview by job_id for applicant job:",n.job_id),(a=(await l.pR.from("interviews").select("*").eq("job_id",n.job_id).order("created_at",{ascending:!1}).limit(1).single()).data)&&console.log("[InterviewDetail API] ✅ Found most recent interview for job")),!a)return console.error("[InterviewDetail API] Interview not found after trying all methods"),console.error("[InterviewDetail API] Applicant data:",n),s.NextResponse.json({error:"Interview not found",applicantId:t,applicantData:n},{status:404});return console.log("[InterviewDetail API] ✅ Interview found:",a.id),s.NextResponse.json({success:!0,data:{id:a.id,name:n?.name||"Candidate Interview",email:n?.email||a.client||"Unknown",position:n?.position_applied||a.position||"Unknown",job_id:a.job_id,duration:a.duration||0,timestamp:a.timestamp||a.created_at,skills:a.skills||[],conversation:a.conversation||[],notes:a.notes||"",analysis:a.analysis||null,applicantInfo:{name:n?.name,email:n?.email,position_applied:n?.position_applied,applied_on:n?.created_at,status:n?.status}}})}catch(e){return console.error("[InterviewDetail API] Error:",e),s.NextResponse.json({error:e.message||"Internal server error"},{status:500})}}let c=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/interview-detail/route",pathname:"/api/interview-detail",filename:"route",bundlePath:"app/api/interview-detail/route"},resolvedPagePath:"C:\\Users\\omt91\\Downloads\\main\\interviewverse_frontend\\app\\api\\interview-detail\\route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:v,staticGenerationAsyncStorage:u,serverHooks:w}=c,m="/api/interview-detail/route";function I(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:u})}},85662:(e,i,t)=>{t.d(i,{OQ:()=>s,pR:()=>l});var n=t(76596);let r=process.env.NEXT_PUBLIC_SUPABASE_URL,a=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,o=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!r||!a)throw Error("Missing Supabase environment variables");let s=(0,n.eI)(r,a),l=(0,n.eI)(r,o||a)}};var i=require("../../../webpack-runtime.js");i.C(e);var t=e=>i(i.s=e),n=i.X(0,[8948,5972,6596],()=>t(46310));module.exports=n})();