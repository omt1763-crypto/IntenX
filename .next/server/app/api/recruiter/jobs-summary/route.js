"use strict";(()=>{var e={};e.id=4457,e.ids=[4457],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35680:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>h,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>_});var a={};t.r(a),t.d(a,{GET:()=>GET,dynamic:()=>l,revalidate:()=>c});var o=t(10884),i=t(16132),n=t(95798),s=t(47770);let l="force-dynamic",c=0;async function GET(e){try{let{searchParams:r}=new URL(e.url),t=r.get("recruiterId");if(!t)return n.Z.json({error:"Missing recruiterId",success:!1},{status:400});console.log("[JobsSummary API] Fetching summary for recruiter:",t);let{data:a,error:o}=await s.pR.from("jobs").select("*").eq("recruiter_id",t).order("created_at",{ascending:!1}).limit(200);o&&console.error("[JobsSummary API] Jobs error:",o);let i=(a||[]).map(e=>e.id).filter(Boolean),l=[];if(i.length>0){let{data:e,error:r}=await s.pR.from("job_applicants").select("*").in("job_id",i).order("created_at",{ascending:!1});r&&console.error("[JobsSummary API] Applicants error:",r),l=e||[]}let c=[];if(i.length>0){let{data:e,error:r}=await s.pR.from("interviews").select("*").in("job_id",i).order("created_at",{ascending:!1});r&&console.error("[JobsSummary API] Interviews error:",r),c=e||[]}if((0===c.length||0===i.length)&&l.length>0){let e=l.map(e=>e.id).filter(Boolean);if(e.length>0){console.log("[JobsSummary API] Fetching interviews via applicant_id for",e.length,"applicants");let{data:r,error:t}=await s.pR.from("interviews").select("*").in("applicant_id",e).order("created_at",{ascending:!1});t&&console.warn("[JobsSummary API] Interviews via applicant_id error:",t),c=[...c||[],...r||[]]}}let d={};l.forEach(e=>{e&&e.job_id&&(d[e.job_id]=(d[e.job_id]||0)+1)});let u={};c.forEach(e=>{e&&e.job_id&&(u[e.job_id]=(u[e.job_id]||0)+1)});let p=(a||[]).map(e=>({...e,applicant_count:d[e.id]||0,interview_count:u[e.id]||0})),m={pending:0,shortlisted:0,rejected:0,accepted:0};l.forEach(e=>{let r=e&&e.status||"pending";m.hasOwnProperty(r)?m[r]++:m.pending++});let g=new Date,_=new Date(g.getFullYear(),g.getMonth(),1),h=new Date(g.getFullYear(),g.getMonth()+1,1),b=(a||[]).filter(e=>{try{let r=new Date(e.created_at);return r>=_&&r<h}catch(e){return!1}}).length,w=(a||[]).length,f=w>0?Math.round(b/w*100):0,j={success:!0,jobs:p,totalJobs:w,totalApplicants:l.length,totalInterviews:c.length,applicationStats:m,totalShortlisted:m.shortlisted||0,jobsThisMonth:b,jobPercentOfTotal:f};return n.Z.json(j)}catch(e){return console.error("[JobsSummary API] Error:",e),n.Z.json({success:!1,error:e.message},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/recruiter/jobs-summary/route",pathname:"/api/recruiter/jobs-summary",filename:"route",bundlePath:"app/api/recruiter/jobs-summary/route"},resolvedPagePath:"C:\\Users\\omt91\\Downloads\\main\\interviewverse_frontend\\app\\api\\recruiter\\jobs-summary\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:u,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:g,staticGenerationBailout:_}=d,h="/api/recruiter/jobs-summary/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[729,5798,8617,7770],()=>__webpack_exec__(35680));module.exports=t})();