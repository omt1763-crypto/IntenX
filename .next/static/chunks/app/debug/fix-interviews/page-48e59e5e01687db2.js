(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2315],{2603:function(e,s,t){Promise.resolve().then(t.bind(t,1958))},1958:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return r}});var i=t(7437),l=t(2265),n=t(1233),o=t(8985);function r(){var e;let{user:s}=(0,n.a)(),[t,r]=(0,l.useState)(null),[a,d]=(0,l.useState)(!1),[c,b]=(0,l.useState)(!1),[x,h]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),j=async()=>{d(!0),h("");try{let e=await fetch("/api/fix-interview-job-ids?recruiterId=".concat(null==s?void 0:s.id)),t=await e.json();console.log("Diagnostics result:",t),r(t.diagnostics),t.diagnostics.interviews_without_job_id>0?h("ISSUE FOUND: ".concat(t.diagnostics.interviews_without_job_id," interviews are missing job_id!")):h("✅ All interviews have job_id. No issues found.")}catch(e){console.error("Diagnostic error:",e),h("Error running diagnostics: "+e)}finally{d(!1)}},g=async()=>{if(!u){h("Please select a job ID to link interviews to");return}b(!0),h("");try{let e=await fetch("/api/fix-interview-job-ids",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recruiterId:null==s?void 0:s.id,jobId:u})}),t=await e.json();console.log("Fix result:",t),h(t.message||"Fix completed"),await j()}catch(e){console.error("Fix error:",e),h("Error fixing interviews: "+e)}finally{b(!1)}};return(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-50",children:[(0,i.jsx)(o.Z,{role:"recruiter"}),(0,i.jsx)("main",{className:"ml-64 p-8",children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Interview Diagnostics & Fix"}),(0,i.jsx)("p",{className:"text-slate-600 mb-8",children:"Debug why interviews aren't showing on the dashboard"}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-slate-900 mb-4",children:"Run Diagnostics"}),(0,i.jsx)("button",{onClick:j,disabled:a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 transition font-semibold",children:a?"Running...":"Run Diagnostics"})]}),x&&(0,i.jsx)("div",{className:"p-4 rounded-lg mb-6 ".concat(x.includes("ISSUE")?"bg-red-50 text-red-800 border border-red-200":"bg-green-50 text-green-800 border border-green-200"),children:x}),t&&(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-slate-900 mb-4",children:"Diagnostics Results"}),(0,i.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,i.jsxs)("div",{className:"border-l-4 border-blue-500 pl-4",children:[(0,i.jsx)("p",{className:"text-sm text-slate-600",children:"Total Jobs"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:t.total_jobs})]}),(0,i.jsxs)("div",{className:"border-l-4 border-green-500 pl-4",children:[(0,i.jsx)("p",{className:"text-sm text-slate-600",children:"Interviews with job_id"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:t.interviews_with_job_id})]}),(0,i.jsxs)("div",{className:"border-l-4 ".concat(t.interviews_without_job_id>0?"border-red-500":"border-green-500"," pl-4"),children:[(0,i.jsx)("p",{className:"text-sm text-slate-600",children:"Interviews WITHOUT job_id ⚠️"}),(0,i.jsx)("p",{className:"text-2xl font-bold ".concat(t.interviews_without_job_id>0?"text-red-600":"text-green-600"),children:t.interviews_without_job_id})]})]}),t.interviews_without_job_id>0&&(0,i.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[(0,i.jsx)("h3",{className:"font-semibold text-yellow-900 mb-4",children:"Fix Missing job_id Values"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Job to Link To:"}),(0,i.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,i.jsx)("option",{value:"",children:"-- Select a job --"}),null===(e=t.jobs)||void 0===e?void 0:e.map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.title," (",e.id.substring(0,8),"...)"]},e.id))]})]}),(0,i.jsx)("button",{onClick:g,disabled:c||!u,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-slate-400 transition font-semibold",children:c?"Fixing...":"Fix All ".concat(t.interviews_without_job_id," Interviews")})]}),t.jobs&&t.jobs.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-semibold text-slate-900 mb-3",children:"Your Jobs"}),(0,i.jsx)("div",{className:"space-y-2",children:t.jobs.map(e=>(0,i.jsxs)("div",{className:"p-3 bg-slate-50 rounded border border-slate-200",children:[(0,i.jsx)("p",{className:"font-medium text-slate-900",children:e.title}),(0,i.jsx)("p",{className:"text-xs text-slate-500 font-mono",children:e.id})]},e.id))})]})]}),(0,i.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,i.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"What's happening?"}),(0,i.jsx)("p",{className:"text-blue-800 text-sm mb-4",children:'When interviews are saved, they should be linked to a job_id so the dashboard can filter and count them correctly. If you see "Interviews WITHOUT job_id" above, it means old interviews don\'t have this linkage.'}),(0,i.jsx)("p",{className:"text-blue-800 text-sm",children:'Click "Fix All [N] Interviews" to automatically link them to the selected job. After fixing, go to your dashboard and refresh to see the interview count update!'})]})]})})]})}}},function(e){e.O(0,[9066,1341,8985,2971,2117,1744],function(){return e(e.s=2603)}),_N_E=e.O()}]);