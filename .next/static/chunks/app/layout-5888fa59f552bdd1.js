(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{1707:function(e,t,o){Promise.resolve().then(o.bind(o,9431)),Promise.resolve().then(o.bind(o,4678)),Promise.resolve().then(o.bind(o,5046)),Promise.resolve().then(o.t.bind(o,2390,23))},9431:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return SecurityWrapper}});var r=o(7437),n=o(2265),s=o(2601);function disableConsoleInProduction(){let e="production"===s.env.NEXT_PUBLIC_ENVIRONMENT;if(e){let noop=()=>{};console.log=noop,console.error=noop,console.warn=noop,console.info=noop,console.debug=noop,console.trace=noop,document.addEventListener("keydown",e=>{if("F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"C"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key)return e.preventDefault(),!1})}}function disableContextMenuInProduction(){let e="production"===s.env.NEXT_PUBLIC_ENVIRONMENT;e&&document.addEventListener("contextmenu",e=>(e.preventDefault(),!1))}var l=o(2601);function SecurityWrapper(e){let{children:t}=e;return(0,n.useEffect)(()=>{if(disableConsoleInProduction(),disableContextMenuInProduction(),"production"===l.env.NEXT_PUBLIC_ENVIRONMENT){Object.defineProperty(window,"console",{value:new Proxy(console,{get:()=>void 0}),writable:!1});let e=Storage.prototype.getItem;Storage.prototype.getItem=function(t){return t.includes("auth")||t.includes("token")||t.includes("debug")?(console.warn=()=>{},null):e.call(this,t)}}},[]),(0,r.jsx)(r.Fragment,{children:t})}},4678:function(e,t,o){"use strict";o.r(t),o.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=o(7437),n=o(2265),s=o(2899);let l=(0,n.createContext)();function AuthProvider(e){let{children:t}=e,[o,u]=(0,n.useState)(null),[i,a]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[h,g]=(0,n.useState)(!1),[S,f]=(0,n.useState)(!1),saveAuthState=(e,t,o)=>{let r={user:e,session:t,role:o,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(r)),console.log("[Auth] Auth state saved to localStorage")},loadAuthState=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let o=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=o.user)||void 0===e?void 0:e.email),o}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},clearAuthState=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,n.useEffect)(()=>{let e=loadAuthState();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)&&(console.log("[Auth] Restored session from localStorage:",e.user.email),u(e.user),a(e.session),d(e.role),f(!0));let verifySession=async()=>{try{let{data:{session:t}}=await s.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] Valid Supabase session found"),a(t),u(t.user),f(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),saveAuthState(t.user,t,e.role))}else(null==e?void 0:e.user)||(a(null),u(null),d(null),f(!1),clearAuthState())}catch(e){console.warn("[Auth] Session verification error:",e.message)}};verifySession();let{data:{subscription:t}}=s.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){a(t),u(t.user),f(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),saveAuthState(t.user,t,e.role))}else a(null),u(null),d(null),f(!1),clearAuthState()});return()=>null==t?void 0:t.unsubscribe()},[]);let signup=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let o=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!o.ok){let e=await o.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let r=await o.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:r.user,needsLogin:!0,message:r.message}}catch(e){throw console.error("[Signup] Error:",e),e}},login=async(e,t,o)=>{try{var r,n;console.log("[AuthContext] Attempting login:",{email:e,role:o});let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:o})});if(console.log("[AuthContext] Login response status:",s.status),!s.ok){let e=await s.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let l=await s.json();console.log("[AuthContext] Login successful, setting session"),l.session&&(a(l.session),u(l.session.user||l.user));let i=(null===(r=l.user)||void 0===r?void 0:r.role)||o;return d(i),f(!0),saveAuthState((null===(n=l.session)||void 0===n?void 0:n.user)||l.user,l.session,i),console.log("[AuthContext] Auth state saved to localStorage"),l.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},logout=async()=>{try{await s.OQ.auth.signOut(),a(null),u(null),d(null),f(!1),clearAuthState(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,r.jsx)(l.Provider,{value:{user:o,session:i,role:c,loading:h,isAuthenticated:S,signup,login,logout},children:t})}let useAuth=()=>{let e=(0,n.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},5046:function(e,t,o){"use strict";o.r(t),o.d(t,{SidebarProvider:function(){return SidebarProvider},useSidebar:function(){return useSidebar}});var r=o(7437),n=o(2265);let s=(0,n.createContext)(void 0);function SidebarProvider(e){let{children:t}=e,[o,l]=(0,n.useState)(!0);return(0,r.jsx)(s.Provider,{value:{isOpen:o,setIsOpen:l},children:t})}function useSidebar(){let e=(0,n.useContext)(s);if(!e)throw Error("useSidebar must be used within SidebarProvider");return e}},2899:function(e,t,o){"use strict";o.d(t,{OQ:function(){return i}});var r=o(6932),n=o(2601);let s=n.env.NEXT_PUBLIC_SUPABASE_URL,l=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,u=n.env.SUPABASE_SERVICE_ROLE_KEY;if(!s||!l)throw Error("Missing Supabase environment variables");let i=(0,r.eI)(s,l);(0,r.eI)(s,u||l)},2390:function(){}},function(e){e.O(0,[7653,2971,2472,1744],function(){return e(e.s=1707)}),_N_E=e.O()}]);