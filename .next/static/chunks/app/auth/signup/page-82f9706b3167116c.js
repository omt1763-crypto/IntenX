(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5271],{9463:function(e,t,s){Promise.resolve().then(s.bind(s,8640))},8640:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var r=s(7437),a=s(2265),l=s(9376),o=s(3287),n=s(6124),i=s(8512),c=s(2857),u=s(6367),d=s(1456),m=s(7367),h=s(7648),p=s(1233);function g(){let[e,t]=(0,a.useState)(!1),[s,g]=(0,a.useState)("candidate"),[x,f]=(0,a.useState)(""),[y,v]=(0,a.useState)(""),[b,w]=(0,a.useState)(""),[N,j]=(0,a.useState)(""),[S,k]=(0,a.useState)(""),[A,E]=(0,a.useState)(!1),[C,P]=(0,a.useState)(""),Z=(0,l.useRouter)(),{signup:O}=(0,p.a)();(0,a.useEffect)(()=>{t(!0)},[]);let L=async e=>{if(e.preventDefault(),k(""),P(""),E(!0),!x||!y||!b||!N){k("Please fill in all fields"),E(!1);return}if(N.length<6){k("Password must be at least 6 characters"),E(!1);return}try{await O({firstName:x,lastName:y,email:b,password:N},s),console.log("[Signup Form] Account created successfully, redirecting to verify email..."),Z.push("/auth/verify-email-pending?email="+encodeURIComponent(b))}catch(e){k(e.message||"Failed to create account"),E(!1)}},_=[{value:"candidate",label:"Candidate",icon:n.Z},{value:"recruiter",label:"Recruiter",icon:i.Z},{value:"company",label:"Company",icon:c.Z}];return e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-sky-100 via-sky-50 to-blue-100 text-black flex items-center justify-center px-3 sm:px-6 py-8 sm:py-12 relative overflow-x-hidden",children:[(0,r.jsx)("style",{children:"\n    @keyframes pulse-glow {\n      0%, 100% { opacity: 0.4; }\n      50% { opacity: 0.8; }\n    }\n    @keyframes float-wave {\n      0%, 100% { transform: translateY(0px); }\n      50% { transform: translateY(-4px); }\n    }\n    @keyframes shimmer {\n      0%, 100% { opacity: 0.4; }\n      50% { opacity: 1; }\n    }\n    @keyframes spin-slow {\n      from { transform: rotate(0deg); }\n      to { transform: rotate(360deg); }\n    }\n    .animate-pulse-glow { animation: pulse-glow 3s ease-in-out infinite; }\n    .animate-float-wave { animation: float-wave 2.5s ease-in-out infinite; }\n    .animate-shimmer { animation: shimmer 2s ease-in-out infinite; }\n    .animate-spin-slow { animation: spin-slow 8s linear infinite; }\n    @keyframes card-glow {\n      0%, 100% {\n        border-color: rgba(107, 114, 128, 0.5);\n        box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);\n      }\n      50% {\n        border-color: rgba(59, 130, 246, 0.8);\n        box-shadow: 0 0 30px 5px rgba(59, 130, 246, 0.4);\n      }\n    }\n    .card-glow-hover:hover { animation: card-glow 2s ease-in-out forwards; }\n  "}),(0,r.jsx)(h.default,{href:"/",className:"absolute top-6 sm:top-8 left-4 sm:left-8 z-50",children:(0,r.jsx)(o.E.button,{whileHover:{scale:1.05},className:"p-2 rounded-full bg-white/70 border border-sky-200 hover:border-purple-400 transition-all",children:(0,r.jsx)(u.Z,{className:"w-4 sm:w-5 h-4 sm:h-5 text-purple-600"})})}),(0,r.jsxs)(o.E.div,{className:"w-full max-w-sm relative z-10",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}}},initial:"hidden",animate:"visible",children:[(0,r.jsxs)("div",{className:"rounded-2xl sm:rounded-3xl border border-sky-200 p-4 sm:p-6 md:p-7 bg-white/95 shadow-lg",children:[(0,r.jsxs)("div",{className:"text-center mb-6 sm:mb-7",children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-1 sm:mb-2",children:"Create Account"}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-700 font-light",children:"Join InterviewX and get started today"})]}),(0,r.jsxs)("form",{onSubmit:L,className:"space-y-3 sm:space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm font-semibold text-gray-800 mb-1 sm:mb-1.5",children:"First Name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.Z,{className:"absolute left-3 top-2.5 sm:top-3 w-4 sm:w-5 h-4 sm:h-5 text-gray-600 opacity-60"}),(0,r.jsx)("input",{type:"text",value:x,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"===e.key&&x&&y&&b&&N&&!A&&L(e)},placeholder:"John",className:"w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 rounded-lg bg-white border border-sky-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400 transition-all text-xs sm:text-sm"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm font-semibold text-gray-800 mb-1 sm:mb-1.5",children:"Last Name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.Z,{className:"absolute left-3 top-2.5 sm:top-3 w-4 sm:w-5 h-4 sm:h-5 text-gray-600 opacity-60"}),(0,r.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"===e.key&&x&&y&&b&&N&&!A&&L(e)},placeholder:"Doe",className:"w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 rounded-lg bg-white border border-sky-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400 transition-all text-xs sm:text-sm"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm font-semibold text-gray-800 mb-1 sm:mb-1.5",children:"Email Address"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Z,{className:"absolute left-3 top-2.5 sm:top-3 w-4 sm:w-5 h-4 sm:h-5 text-gray-600 opacity-60"}),(0,r.jsx)("input",{type:"email",value:b,onChange:e=>{w(e.target.value),P("")},onKeyPress:e=>{"Enter"===e.key&&x&&y&&b&&N&&!A&&L(e)},placeholder:"your@email.com",className:"w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 rounded-lg bg-white border text-gray-900 placeholder-gray-400 focus:outline-none transition-all text-xs sm:text-sm ".concat(C?"border-red-400 focus:border-red-500 focus:ring-1 focus:ring-red-400":"border-sky-200 focus:border-purple-400 focus:ring-1 focus:ring-purple-400")})]}),C&&(0,r.jsx)("p",{className:"text-xs text-red-600 mt-1",children:C})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm font-semibold text-gray-800 mb-1 sm:mb-1.5",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m.Z,{className:"absolute left-3 top-2.5 sm:top-3 w-4 sm:w-5 h-4 sm:h-5 text-gray-600 opacity-60"}),(0,r.jsx)("input",{type:"password",value:N,onChange:e=>j(e.target.value),onKeyPress:e=>{"Enter"===e.key&&x&&y&&b&&N&&!A&&L(e)},placeholder:"••••••••",className:"w-full pl-9 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 rounded-lg bg-white border border-sky-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-400 transition-all text-xs sm:text-sm"})]}),N&&(0,r.jsx)("p",{className:"text-xs mt-1 ".concat(N.length>=6?"text-green-600":"text-orange-600"),children:N.length>=6?"✓ Password is valid (6+ characters)":"".concat(6-N.length," more character").concat(6-N.length!=1?"s":""," needed")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs sm:text-sm font-semibold text-gray-800 mb-2 sm:mb-2.5",children:"I am a"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:_.map(e=>{let t=e.icon,a=s===e.value;return(0,r.jsxs)(o.E.button,{type:"button",onClick:()=>g(e.value),whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative py-2.5 sm:py-3 px-2 sm:px-3 rounded-lg sm:rounded-xl transition-all duration-200 flex flex-col items-center gap-1 sm:gap-1.5 font-semibold text-xs sm:text-sm ".concat(a?"bg-purple-600 border-2 border-purple-600 text-white shadow-lg shadow-purple-500/30":"bg-gray-50 border-2 border-sky-200 text-gray-700 hover:border-purple-300"),children:[(0,r.jsx)(t,{className:"w-4 sm:w-5 h-4 sm:h-5"}),(0,r.jsx)("span",{className:"text-xs",children:e.label})]},e.value)})})]}),S&&(0,r.jsx)("div",{className:"p-2.5 sm:p-3 rounded-lg bg-red-100 border border-red-300 text-red-700 text-xs sm:text-sm",children:S}),(0,r.jsx)("div",{className:"h-px bg-gradient-to-r from-transparent via-sky-200 to-transparent"}),(0,r.jsx)(o.E.button,{onClick:L,disabled:!x||!y||!b||!N||A,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-2.5 sm:py-3 rounded-lg bg-purple-600 text-white font-semibold transition-all duration-200 hover:bg-purple-700 hover:shadow-lg hover:shadow-purple-500/30 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",children:A?(0,r.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"inline-block animate-spin",children:"⚙️"}),"Creating Account..."]}):"Create Account"}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-700",children:["Already have an account?"," ",(0,r.jsx)(h.default,{href:"/auth/login",className:"font-semibold text-purple-600 hover:text-purple-700 transition",children:"Sign in"})]})})]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 text-center mt-4 sm:mt-6 font-light",children:["By signing up, you agree to our"," ",(0,r.jsx)(h.default,{href:"#",className:"hover:text-purple-600 transition",children:"Terms of Service"})," ","and"," ",(0,r.jsx)(h.default,{href:"#",className:"hover:text-purple-600 transition",children:"Privacy Policy"})]})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-slate-400",children:"Loading..."})})}},1233:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return n},a:function(){return i}});var r=s(7437),a=s(2265),l=s(2141);let o=(0,a.createContext)();function n(e){let{children:t}=e,[s,n]=(0,a.useState)(null),[i,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),y=(e,t,s)=>{let r={user:e,session:t,role:s,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(r)),console.log("[Auth] Auth state saved to localStorage")},v=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let s=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=s.user)||void 0===e?void 0:e.email),s}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},b=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,a.useEffect)(()=>{let e=v();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)?(console.log("[Auth] ✅ Restored session from localStorage:",e.user.email),n(e.user),c(e.session),d(e.role),g(!0),f(!0)):console.log("[Auth] ⏳ No cached session, verifying with Supabase...");let t=async()=>{try{let{data:{session:t}}=await l.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] ✅ Valid Supabase session found"),c(t),n(t.user),g(!0);let{data:e}=await l.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),y(t.user,t,e.role))}else(null==e?void 0:e.user)||(console.log("[Auth] ❌ No session found anywhere"),c(null),n(null),d(null),g(!1),b());f(!0)}catch(e){console.warn("[Auth] ⚠️ Session verification error:",e.message),f(!0)}};(null==e?void 0:e.user)?t().catch(e=>console.warn("[Auth] Background verification failed:",e)):t();let{data:{subscription:r}}=l.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){console.log("[Auth] Session valid, updating state"),c(t),n(t.user),g(!0);let{data:e}=await l.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),y(t.user,t,e.role))}else if("SIGNED_OUT"===e)console.log("[Auth] User signed out, clearing session"),c(null),n(null),d(null),g(!1),b();else{let e=v();if(null==e?void 0:e.user){var r;console.log("[Auth] Keeping cached session for:",null===(r=e.user)||void 0===r?void 0:r.email),s||(n(e.user),c(e.session),d(e.role),g(!0))}else console.log("[Auth] No current session and no cached session"),g(!1)}});return()=>null==r?void 0:r.unsubscribe()},[]);let w=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let s=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!s.ok){let e=await s.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let r=await s.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:r.user,needsLogin:!0,message:r.message}}catch(e){throw console.error("[Signup] Error:",e),e}},N=async(e,t,s)=>{try{var r,a;console.log("[AuthContext] Attempting login:",{email:e,role:s});let l=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:s})});if(console.log("[AuthContext] Login response status:",l.status),!l.ok){let e=await l.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let o=await l.json();console.log("[AuthContext] Login successful, setting session"),o.session&&(c(o.session),n(o.session.user||o.user));let i=(null===(r=o.user)||void 0===r?void 0:r.role)||s;return d(i),g(!0),y((null===(a=o.session)||void 0===a?void 0:a.user)||o.user,o.session,i),console.log("[AuthContext] Auth state saved to localStorage"),o.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},j=async()=>{try{await l.OQ.auth.signOut(),c(null),n(null),d(null),g(!1),b(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,r.jsx)(o.Provider,{value:{user:s,session:i,role:u,loading:m,isAuthenticated:p,isHydrated:x,signup:w,login:N,logout:j},children:t})}let i=()=>{let e=(0,a.useContext)(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},2141:function(e,t,s){"use strict";s.d(t,{OQ:function(){return i}});var r=s(9066),a=s(257);let l=a.env.NEXT_PUBLIC_SUPABASE_URL,o=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,n=a.env.SUPABASE_SERVICE_ROLE_KEY;if(!l||!o)throw Error("Missing Supabase environment variables");let i=(0,r.eI)(l,o);(0,r.eI)(l,n||o)},6367:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8512:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])},2857:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},7367:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1456:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6124:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(8301).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[9066,1341,3287,2971,2117,1744],function(){return e(e.s=9463)}),_N_E=e.O()}]);