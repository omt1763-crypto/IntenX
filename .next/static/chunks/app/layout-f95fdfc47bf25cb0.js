(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{8276:function(e,t,o){Promise.resolve().then(o.bind(o,174)),Promise.resolve().then(o.bind(o,1233)),Promise.resolve().then(o.bind(o,9358)),Promise.resolve().then(o.t.bind(o,4354,23))},174:function(e,t,o){"use strict";o.d(t,{default:function(){return u}});var n=o(7437),r=o(2265),s=o(257),l=o(257);function u(e){let{children:t}=e;return(0,r.useEffect)(()=>{if(function(){if("production"===s.env.NEXT_PUBLIC_ENVIRONMENT){let e=()=>{};console.log=e,console.error=e,console.warn=e,console.info=e,console.debug=e,console.trace=e,document.addEventListener("keydown",e=>{if("F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"C"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key)return e.preventDefault(),!1})}}(),"production"===s.env.NEXT_PUBLIC_ENVIRONMENT&&document.addEventListener("contextmenu",e=>(e.preventDefault(),!1)),"production"===l.env.NEXT_PUBLIC_ENVIRONMENT){Object.defineProperty(window,"console",{value:new Proxy(console,{get:()=>void 0}),writable:!1});let e=Storage.prototype.getItem;Storage.prototype.getItem=function(t){return t.includes("auth")||t.includes("token")||t.includes("debug")?(console.warn=()=>{},null):e.call(this,t)}}},[]),(0,n.jsx)(n.Fragment,{children:t})}},1233:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return u},a:function(){return i}});var n=o(7437),r=o(2265),s=o(2141);let l=(0,r.createContext)();function u(e){let{children:t}=e,[o,u]=(0,r.useState)(null),[i,a]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),[S,m]=(0,r.useState)(!1),p=(e,t,o)=>{let n={user:e,session:t,role:o,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(n)),console.log("[Auth] Auth state saved to localStorage")},A=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let o=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=o.user)||void 0===e?void 0:e.email),o}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},w=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,r.useEffect)(()=>{let e=A();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)?(console.log("[Auth] ✅ Restored session from localStorage:",e.user.email),u(e.user),a(e.session),d(e.role),v(!0),m(!0)):console.log("[Auth] ⏳ No cached session, verifying with Supabase...");let t=async()=>{try{let{data:{session:t}}=await s.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] ✅ Valid Supabase session found"),a(t),u(t.user),v(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),p(t.user,t,e.role))}else(null==e?void 0:e.user)||(console.log("[Auth] ❌ No session found anywhere"),a(null),u(null),d(null),v(!1),w());m(!0)}catch(e){console.warn("[Auth] ⚠️ Session verification error:",e.message),m(!0)}};(null==e?void 0:e.user)?t().catch(e=>console.warn("[Auth] Background verification failed:",e)):t();let{data:{subscription:n}}=s.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){console.log("[Auth] Session valid, updating state"),a(t),u(t.user),v(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),p(t.user,t,e.role))}else if("SIGNED_OUT"===e)console.log("[Auth] User signed out, clearing session"),a(null),u(null),d(null),v(!1),w();else{let e=A();if(null==e?void 0:e.user){var n;console.log("[Auth] Keeping cached session for:",null===(n=e.user)||void 0===n?void 0:n.email),o||(u(e.user),a(e.session),d(e.role),v(!0))}else console.log("[Auth] No current session and no cached session"),v(!1)}});return()=>null==n?void 0:n.unsubscribe()},[]);let y=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let o=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!o.ok){let e=await o.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let n=await o.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:n.user,needsLogin:!0,message:n.message}}catch(e){throw console.error("[Signup] Error:",e),e}},E=async(e,t,o)=>{try{var n,r;console.log("[AuthContext] Attempting login:",{email:e,role:o});let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:o})});if(console.log("[AuthContext] Login response status:",s.status),!s.ok){let e=await s.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let l=await s.json();console.log("[AuthContext] Login successful, setting session"),l.session&&(a(l.session),u(l.session.user||l.user));let i=(null===(n=l.user)||void 0===n?void 0:n.role)||o;return d(i),v(!0),p((null===(r=l.session)||void 0===r?void 0:r.user)||l.user,l.session,i),console.log("[AuthContext] Auth state saved to localStorage"),l.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},N=async()=>{try{await s.OQ.auth.signOut(),a(null),u(null),d(null),v(!1),w(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,n.jsx)(l.Provider,{value:{user:o,session:i,role:c,loading:h,isAuthenticated:f,isHydrated:S,signup:y,login:E,logout:N},children:t})}let i=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9358:function(e,t,o){"use strict";o.d(t,{A:function(){return u},SidebarProvider:function(){return l}});var n=o(7437),r=o(2265);let s=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[o,l]=(0,r.useState)(!0);return(0,n.jsx)(s.Provider,{value:{isOpen:o,setIsOpen:l},children:t})}function u(){let e=(0,r.useContext)(s);if(!e)throw Error("useSidebar must be used within SidebarProvider");return e}},2141:function(e,t,o){"use strict";o.d(t,{OQ:function(){return i}});var n=o(9066),r=o(257);let s=r.env.NEXT_PUBLIC_SUPABASE_URL,l=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,u=r.env.SUPABASE_SERVICE_ROLE_KEY;if(!s||!l)throw Error("Missing Supabase environment variables");let i=(0,n.eI)(s,l);(0,n.eI)(s,u||l)},4354:function(){}},function(e){e.O(0,[3554,9066,2971,2117,1744],function(){return e(e.s=8276)}),_N_E=e.O()}]);