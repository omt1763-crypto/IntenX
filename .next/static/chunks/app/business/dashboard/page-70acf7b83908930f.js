(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42],{60405:function(e,t,s){Promise.resolve().then(s.bind(s,97069))},97069:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(57437),r=s(2265),l=s(99376),o=s(2141),i=s(1233),n=s(69358),d=s(18985),c=s(15291),m=s(31338),x=s(18512);let h=(0,s(8301).Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);var b=s(49421),u=s(81359);function p(){let e=(0,l.useRouter)(),{user:t,isAuthenticated:s,loading:p,role:g}=(0,i.a)(),{isOpen:j}=(0,n.A)(),[f,w]=(0,r.useState)([]),[v,N]=(0,r.useState)([]),[y,k]=(0,r.useState)({totalJobs:0,totalCandidates:0,totalInterviews:0,shortlisted:0,jobPercent:0,jobPercentDirection:"none"}),[Z,C]=(0,r.useState)(!0),[D,_]=(0,r.useState)(!1),A=null==t?void 0:t.id;(0,r.useEffect)(()=>{p||A||s||t||e.replace("/auth/login")},[p,A,s,t,e]),(0,r.useEffect)(()=>{!p&&g&&"business"!==g&&"company"!==g&&(console.log("[BusinessDashboard] User role is",g,", not business/company. Redirecting to","recruiter"===g?"/recruiter/dashboard":"/auth/login"),e.replace("recruiter"===g?"/recruiter/dashboard":"/auth/login"))},[p,g,e]),(0,r.useEffect)(()=>{_(!0)},[]),(0,r.useEffect)(()=>{A&&D&&!p&&I()},[A,D,p]);let I=async()=>{try{if(!A)return;k(e=>({...e,totalJobs:0,totalCandidates:0,totalInterviews:0,shortlisted:0})),C(!1);try{let e=await fetch("/api/recruiter/jobs-summary?recruiterId=".concat(A)),t=await e.json();if(t&&t.success&&t.jobs){let e=t.jobs;w(e);let s=e.reduce((e,t)=>e+(t.interview_count||0),0);k(t=>({...t,totalJobs:e.length,totalCandidates:e.reduce((e,t)=>e+(t.applicant_count||0),0),totalInterviews:s})),console.log("[BusinessDashboard] Jobs summary loaded:",{totalJobs:e.length,totalCandidates:e.reduce((e,t)=>e+(t.applicant_count||0),0),totalInterviews:s});let a=await fetch("/api/get-applicants?recruiterId=".concat(A)),r=await a.json();r&&r.data&&N(r.data.slice(0,5));try{let e=await fetch("/api/get-interviews?recruiterId=".concat(A)),t=await e.json();t&&t.data&&t.count&&(console.log("[BusinessDashboard] Total interviews (including legacy):",t.count),k(e=>({...e,totalInterviews:t.count})))}catch(e){console.warn("[BusinessDashboard] Error fetching all interviews:",e)}}}catch(e){console.warn("[BusinessDashboard] Jobs fetch error:",e)}try{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1).toISOString(),s=new Date(e.getFullYear(),e.getMonth()-1,1).toISOString(),{count:a}=await o.OQ.from("jobs").select("*",{count:"exact"}).gte("created_at",t).eq("recruiter_id",A),{count:r}=await o.OQ.from("jobs").select("*",{count:"exact"}).gte("created_at",s).lt("created_at",t).eq("recruiter_id",A),l=a||0,i=r||0,n=0,d="none";0===i&&l>0?(n=100,d="up"):0===i&&0===l?(n=0,d="none"):d=(n=Math.round((l-i)/Math.max(1,i)*100))>0?"up":n<0?"down":"none",k(e=>({...e,jobPercent:n,jobPercentDirection:d}))}catch(e){console.warn("[BusinessDashboard] Job percent calculation error:",e)}}catch(e){console.error("[BusinessDashboard] Error:",e),C(!1)}};return D?(0,a.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-white via-blue-50/30 to-purple-50/20 text-slate-900",suppressHydrationWarning:!0,children:[(0,a.jsx)(d.Z,{role:"company"},"business-sidebar"),(0,a.jsx)("div",{className:"relative z-10 transition-all duration-300 ".concat(j?"md:ml-64":"md:ml-20"," pt-16 md:pt-24 pb-16 min-h-screen"),children:(0,a.jsx)("div",{className:"w-full px-4 sm:px-6 md:px-8 lg:px-12",children:Z?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)("p",{className:"text-slate-600 text-lg",children:"Loading dashboard..."})}):A||s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 md:mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold text-slate-900 mb-2",children:"Company Hub"}),(0,a.jsx)("p",{className:"text-base sm:text-lg text-slate-600 font-light",children:"Manage jobs, track candidates, and conduct interviews"})]}),(0,a.jsx)("div",{className:"mb-6 md:mb-8",children:(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Performance Analytics"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10 mb-8",children:[(0,a.jsxs)(c.Z,{hover:!0,children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Jobs Posted Trend"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mt-2",children:"Last 7 days"})]}),(0,a.jsx)("div",{className:"h-64 sm:h-72 md:h-80 flex items-end justify-between gap-2 sm:gap-4 px-4 sm:px-6 py-6 bg-gray-50 rounded-lg overflow-x-auto",children:f.length>0?(()=>{let e=Array.from({length:7},(e,t)=>{let s=new Date;return s.setDate(s.getDate()-(6-t)),s.toDateString()}).map(e=>f.filter(t=>new Date(t.created_at).toDateString()===e).length),t=Math.max(...e,1);return e.map((e,s)=>(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-2 sm:gap-3 group min-w-[2rem]",children:[(0,a.jsx)("div",{className:"w-full h-full bg-gradient-to-t from-blue-500 to-blue-400 rounded-lg shadow-md hover:shadow-lg transition group-hover:from-blue-600 group-hover:to-blue-500",style:{height:"".concat(e/t*240,"px")}}),(0,a.jsx)("span",{className:"text-xs text-gray-600 font-semibold text-center",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][s]})]},s))})():(0,a.jsx)("div",{className:"flex items-center justify-center w-full h-64",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No job data"})})}),(0,a.jsx)("button",{onClick:()=>e.push("/business/dashboard/jobs"),className:"w-full mt-6 py-2.5 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 text-white font-medium hover:shadow-lg transition-all hover:scale-105 text-sm sm:text-base",children:"View All Jobs"})]}),(0,a.jsxs)(c.Z,{hover:!0,gradient:"purple",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 font-semibold",children:"Total Applicants"}),(0,a.jsx)("p",{className:"text-4xl font-bold text-gray-900 mt-2",children:y.totalCandidates})]}),(0,a.jsx)(m.Z,{className:"w-12 h-12 text-purple-500/20"})]}),(0,a.jsxs)("div",{className:"pt-6 border-t border-gray-200/50",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-4",children:"Quick Action"}),(0,a.jsx)("button",{onClick:()=>e.push("/business/dashboard/applicants"),className:"w-full py-2.5 rounded-lg bg-gradient-to-r from-purple-600 to-purple-700 text-white font-medium hover:shadow-lg transition-all hover:scale-105",children:"View Applicants"})]})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Key Metrics"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[(0,a.jsxs)(c.Z,{hover:!0,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Jobs"}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mt-1",children:y.totalJobs})]}),(0,a.jsx)(x.Z,{className:"w-8 sm:w-10 h-8 sm:h-10 text-blue-500/20"})]}),"up"===y.jobPercentDirection&&(0,a.jsxs)("p",{className:"text-xs text-green-600 font-semibold mt-4 flex items-center gap-1",children:[(0,a.jsx)(h,{size:12})," ",y.jobPercent,"% this month"]})]}),(0,a.jsx)(c.Z,{hover:!0,gradient:"yellow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Interviews Conducted"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:y.totalInterviews})]}),(0,a.jsx)(b.Z,{className:"w-10 h-10 text-yellow-500/20"})]})}),(0,a.jsx)(c.Z,{hover:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Candidates"}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mt-1",children:y.totalCandidates})]}),(0,a.jsx)(m.Z,{className:"w-8 sm:w-10 h-8 sm:h-10 text-green-500/20"})]})}),(0,a.jsx)(c.Z,{hover:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Interviews"}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mt-1",children:y.totalInterviews})]}),(0,a.jsx)(b.Z,{className:"w-8 sm:w-10 h-8 sm:h-10 text-yellow-500/20"})]})}),"          "]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-12",children:(0,a.jsxs)("div",{className:"relative overflow-hidden rounded-2xl sm:rounded-3xl backdrop-blur-xl bg-white/50 border border-white/60 shadow-lg hover:shadow-2xl transition-all duration-300 p-4 sm:p-6 md:p-8",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white to-[#f0fdf4]/30 opacity-0 hover:opacity-100 transition-opacity"}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-4",children:[(0,a.jsxs)("h2",{className:"text-lg sm:text-2xl font-bold text-slate-900 flex items-center gap-2 sm:gap-3",children:[(0,a.jsx)(m.Z,{className:"w-5 sm:w-6 h-5 sm:h-6 text-[#11cd68]"}),"Recent Applicants"]}),(0,a.jsx)("button",{onClick:()=>e.push("/business/dashboard/applicants"),className:"text-xs sm:text-sm text-[#11cd68] hover:text-[#0fb359] font-semibold transition-colors",children:"View All â†’"})]}),v.length>0?(0,a.jsx)("div",{className:"space-y-2 sm:space-y-3",children:v.map(e=>{var t;return(0,a.jsx)("div",{className:"p-3 sm:p-4 rounded-xl bg-white/50 hover:bg-white/80 border border-white/40 hover:border-white/60 transition-all",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"font-semibold text-slate-900 text-sm sm:text-base",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-slate-600",children:e.position_applied||(null===(t=e.jobs)||void 0===t?void 0:t.title)})]}),(0,a.jsx)("span",{className:"text-xs font-semibold px-3 py-1 rounded-full flex-shrink-0 ".concat("shortlisted"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.status||"Applied"})]})},e.id)})}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-slate-500 text-sm sm:text-base",children:"No applicants yet"})})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[(0,a.jsxs)("button",{onClick:()=>e.push("/business/dashboard/jobs"),className:"group relative overflow-hidden rounded-xl sm:rounded-2xl p-4 sm:p-6 backdrop-blur-xl bg-white/50 border border-white/60 hover:border-white/80 shadow-lg hover:shadow-2xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-cyan-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)(x.Z,{className:"w-6 sm:w-8 h-6 sm:h-8 text-blue-500 mb-2 sm:mb-3"}),(0,a.jsx)("h3",{className:"font-semibold text-slate-900 mb-1 text-sm sm:text-base",children:"Jobs"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-slate-600",children:"Manage your job postings"})]}),(0,a.jsxs)("button",{onClick:()=>e.push("/business/dashboard/applicants"),className:"group relative overflow-hidden rounded-xl sm:rounded-2xl p-4 sm:p-6 backdrop-blur-xl bg-white/50 border border-white/60 hover:border-white/80 shadow-lg hover:shadow-2xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/5 to-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)(m.Z,{className:"w-6 sm:w-8 h-6 sm:h-8 text-green-500 mb-2 sm:mb-3"}),(0,a.jsx)("h3",{className:"font-semibold text-slate-900 mb-1 text-sm sm:text-base",children:"Applicants"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-slate-600",children:"Review candidate applications"})]}),(0,a.jsxs)("button",{onClick:()=>e.push("/business/dashboard/profile"),className:"group relative overflow-hidden rounded-xl sm:rounded-2xl p-4 sm:p-6 backdrop-blur-xl bg-white/50 border border-white/60 hover:border-white/80 shadow-lg hover:shadow-2xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/5 to-pink-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)(b.Z,{className:"w-6 sm:w-8 h-6 sm:h-8 text-purple-500 mb-2 sm:mb-3"}),(0,a.jsx)("h3",{className:"font-semibold text-slate-900 mb-1 text-sm sm:text-base",children:"Company Profile"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-slate-600",children:"Update company information"})]}),(0,a.jsxs)("button",{onClick:()=>e.push("/business/dashboard/billing"),className:"group relative overflow-hidden rounded-xl sm:rounded-2xl p-4 sm:p-6 backdrop-blur-xl bg-white/50 border border-white/60 hover:border-white/80 shadow-lg hover:shadow-2xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-red-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)(u.Z,{className:"w-6 sm:w-8 h-6 sm:h-8 text-orange-500 mb-2 sm:mb-3"}),(0,a.jsx)("h3",{className:"font-semibold text-slate-900 mb-1 text-sm sm:text-base",children:"Billing"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-slate-600",children:"Manage your subscription"})]})]})]}):(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8",children:(0,a.jsxs)("p",{className:"text-yellow-800",children:["Please ",(0,a.jsx)("a",{href:"/auth/login",className:"font-semibold underline",children:"log in"})," to access the dashboard."]})})})})]}):null}},15291:function(e,t,s){"use strict";var a=s(57437),r=s(94508);let l={pink:"bg-gradient-to-br from-flow-pink/50 via-card to-card",blue:"bg-gradient-to-br from-flow-blue/20 via-card to-card",yellow:"bg-gradient-to-br from-flow-yellow/30 via-card to-card",purple:"bg-gradient-to-br from-flow-purple/10 via-card to-card",none:"bg-card"};t.Z=e=>{let{children:t,className:s,gradient:o="none",hover:i=!1}=e;return(0,a.jsx)("div",{className:(0,r.cn)("rounded-lg sm:rounded-2xl border border-border/50 p-4 sm:p-6 shadow-card",l[o],i&&"transition-all duration-300 hover:shadow-lg hover:-translate-y-1",s),children:t})}},94508:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(61994),r=s(53335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},49421:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8301).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},81359:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8301).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])}},function(e){e.O(0,[9066,1341,6137,8985,2971,2117,1744],function(){return e(e.s=60405)}),_N_E=e.O()}]);