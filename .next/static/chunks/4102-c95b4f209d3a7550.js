"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4102],{4102:function(e,t,r){r.d(t,{Z:function(){return Sidebar}});var o=r(7437),s=r(1396),a=r.n(s),n=r(4033),l=r(7865);let i=(0,l.Z)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var u=r(9839),c=r(3731),h=r(8499),d=r(6773),x=r(4862),g=r(4605),p=r(6788),v=r(8066),b=r(7171);let f=(0,l.Z)("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);var m=r(4115),y=r(6486),w=r(4678),S=r(5046);function Sidebar(e){let{role:t="company"}=e,r=(0,n.useRouter)(),s=(0,n.usePathname)(),{logout:l}=(0,w.useAuth)(),{isOpen:j,setIsOpen:A}=(0,S.useSidebar)(),handleLogout=()=>{r.push("/auth/logout")},N="candidate"===t?"/candidate/dashboard":"recruiter"===t?"/recruiter/dashboard":"company"===t?"/business/dashboard":"/dashboard",isActive=e=>e===N?s===N:s.startsWith(e),k=[{href:"".concat(N),label:"Dashboard",icon:i},{href:"".concat(N,"/profile"),label:"My Profile",icon:u.Z},{href:"".concat(N,"/jobs"),label:"Jobs",icon:c.Z},{href:"".concat(N,"/billing"),label:"Billing",icon:h.Z},..."candidate"!==t?[{href:"".concat(N,"/applicants"),label:"Applicants",icon:d.Z}]:[{href:"/interview/mock",label:"Mock Interviews",icon:i}]];return(0,o.jsxs)("div",{className:"fixed left-0 top-0 h-screen z-50 bg-gradient-to-b from-blue-600 via-blue-500 to-purple-600 shadow-lg transition-all duration-300 ".concat(j?"w-64":"w-20"," border-r border-blue-400/20"),children:[(0,o.jsxs)("div",{className:"p-6 border-b border-blue-300/20 flex items-center justify-between",children:[j&&(0,o.jsx)("h2",{className:"text-xl font-bold text-white",children:"InterviewX"}),(0,o.jsx)("button",{onClick:()=>A(!j),className:"text-white hover:text-blue-100 transition-colors",children:j?(0,o.jsx)(x.Z,{size:20}):(0,o.jsx)(g.Z,{size:20})})]}),j&&(0,o.jsxs)("div",{className:"px-6 pt-4 pb-8",children:[(0,o.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-400 flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-white font-bold text-sm",children:"X"})})}),(0,o.jsx)("p",{className:"text-xs text-blue-100",children:"AI Interview Platform"})]}),(0,o.jsx)("nav",{className:"px-4 py-2 space-y-2",children:k.map((e,t)=>{let r=e.icon,s=isActive(e.href);return(0,o.jsx)(a(),{href:e.href,children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 cursor-pointer group ".concat(s?"bg-white/20 text-white shadow-lg":"text-blue-100 hover:bg-white/10"),children:[(0,o.jsx)(r,{className:"w-5 h-5 transition-colors ".concat(s?"text-white":"text-blue-200 group-hover:text-white")}),j&&(0,o.jsx)("span",{className:"font-medium transition-colors ".concat(s?"text-white":"group-hover:text-white"),children:e.label})]})},t)})}),j&&window.location.pathname.startsWith("/debug/data")&&(0,o.jsxs)("div",{className:"mt-8 px-4 pt-6 border-t border-blue-300/30",children:[(0,o.jsx)("p",{className:"text-xs font-semibold text-blue-200 uppercase tracking-wider mb-3 px-4",children:"\uD83D\uDD27 Debug Tools"}),(0,o.jsxs)("nav",{className:"space-y-2",children:[(0,o.jsx)(a(),{href:"/debug/data",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(p.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCCA Overview"})]})}),(0,o.jsx)(a(),{href:"/debug/data?tab=users",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(v.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDC65 Users"})]})}),(0,o.jsx)(a(),{href:"/debug/data?tab=jobs",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(c.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCBC Jobs"})]})}),(0,o.jsx)(a(),{href:"/debug/data?tab=applicants",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(b.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCDD Applicants"})]})}),(0,o.jsx)(a(),{href:"/debug/data?tab=interviews",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(f,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83C\uDFA4 Interviews"})]})}),(0,o.jsx)(a(),{href:"/debug/data?tab=activitylogs",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(m.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDEA8 Activity Logs"})]})})]})]}),(0,o.jsxs)("div",{className:"absolute bottom-6 left-4 right-4 pt-6 border-t border-blue-300/20 space-y-2",children:[j&&(0,o.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg p-2.5 shadow-lg",children:(0,o.jsxs)("button",{onClick:handleLogout,className:"w-full flex items-center justify-center gap-2 px-3 py-1.5 rounded-lg bg-white/20 text-white hover:bg-white/30 transition-all duration-200 group font-medium text-xs shadow-md hover:shadow-lg hover:scale-105 active:scale-95",children:[(0,o.jsx)(y.Z,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:"Logout"})]})}),!j&&(0,o.jsx)("button",{onClick:handleLogout,className:"w-full flex items-center justify-center p-2 rounded-lg bg-red-500/20 text-white hover:bg-red-500/30 transition-all duration-200 group font-medium shadow-md hover:shadow-lg",title:"Logout",children:(0,o.jsx)(y.Z,{className:"w-4 h-4"})}),j&&(0,o.jsx)("p",{className:"text-xs text-blue-100 text-center",children:"\xa9 2024 InterviewX"})]})]})}},4678:function(e,t,r){r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var o=r(7437),s=r(2265),a=r(2899);let n=(0,s.createContext)();function AuthProvider(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[i,u]=(0,s.useState)(null),[c,h]=(0,s.useState)(null),[d,x]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!1),saveAuthState=(e,t,r)=>{let o={user:e,session:t,role:r,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(o)),console.log("[Auth] Auth state saved to localStorage")},loadAuthState=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let r=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=r.user)||void 0===e?void 0:e.email),r}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},clearAuthState=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,s.useEffect)(()=>{let e=loadAuthState();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)&&(console.log("[Auth] Restored session from localStorage:",e.user.email),l(e.user),u(e.session),h(e.role),p(!0));let verifySession=async()=>{try{let{data:{session:t}}=await a.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] Valid Supabase session found"),u(t),l(t.user),p(!0);let{data:e}=await a.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(h(e.role),saveAuthState(t.user,t,e.role))}else(null==e?void 0:e.user)||(u(null),l(null),h(null),p(!1),clearAuthState())}catch(e){console.warn("[Auth] Session verification error:",e.message)}};verifySession();let{data:{subscription:t}}=a.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){u(t),l(t.user),p(!0);let{data:e}=await a.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(h(e.role),saveAuthState(t.user,t,e.role))}else u(null),l(null),h(null),p(!1),clearAuthState()});return()=>null==t?void 0:t.unsubscribe()},[]);let signup=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let r=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!r.ok){let e=await r.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let o=await r.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:o.user,needsLogin:!0,message:o.message}}catch(e){throw console.error("[Signup] Error:",e),e}},login=async(e,t,r)=>{try{var o,s;console.log("[AuthContext] Attempting login:",{email:e,role:r});let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:r})});if(console.log("[AuthContext] Login response status:",a.status),!a.ok){let e=await a.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let n=await a.json();console.log("[AuthContext] Login successful, setting session"),n.session&&(u(n.session),l(n.session.user||n.user));let i=(null===(o=n.user)||void 0===o?void 0:o.role)||r;return h(i),p(!0),saveAuthState((null===(s=n.session)||void 0===s?void 0:s.user)||n.user,n.session,i),console.log("[AuthContext] Auth state saved to localStorage"),n.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},logout=async()=>{try{await a.OQ.auth.signOut(),u(null),l(null),h(null),p(!1),clearAuthState(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,o.jsx)(n.Provider,{value:{user:r,session:i,role:c,loading:d,isAuthenticated:g,signup,login,logout},children:t})}let useAuth=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},5046:function(e,t,r){r.r(t),r.d(t,{SidebarProvider:function(){return SidebarProvider},useSidebar:function(){return useSidebar}});var o=r(7437),s=r(2265);let a=(0,s.createContext)(void 0);function SidebarProvider(e){let{children:t}=e,[r,n]=(0,s.useState)(!0);return(0,o.jsx)(a.Provider,{value:{isOpen:r,setIsOpen:n},children:t})}function useSidebar(){let e=(0,s.useContext)(a);if(!e)throw Error("useSidebar must be used within SidebarProvider");return e}},2899:function(e,t,r){r.d(t,{OQ:function(){return i}});var o=r(6932),s=r(2601);let a=s.env.NEXT_PUBLIC_SUPABASE_URL,n=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,l=s.env.SUPABASE_SERVICE_ROLE_KEY;if(!a||!n)throw Error("Missing Supabase environment variables");let i=(0,o.eI)(a,n);(0,o.eI)(a,l||n)},4115:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8499:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},7171:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},6486:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},4605:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},9839:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8066:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("Users2",[["path",{d:"M14 19a6 6 0 0 0-12 0",key:"vej9p1"}],["circle",{cx:"8",cy:"9",r:"4",key:"143rtg"}],["path",{d:"M22 19a6 6 0 0 0-6-6 4 4 0 1 0 0-8",key:"hqbn22"}]])},6773:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4862:function(e,t,r){r.d(t,{Z:function(){return s}});var o=r(7865);let s=(0,o.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);