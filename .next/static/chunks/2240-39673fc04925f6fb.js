"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2240],{82240:function(e,t,o){o.d(t,{Z:function(){return p}});var n=o(57437),r=o(99376),s=o(1233),a=o(77732),l=o(34906),i=o(81359),u=o(72643),c=o(37721),d=o(46124),h=o(6606);function p(){let e=(0,r.useRouter)(),t=(0,r.usePathname)(),{logout:o}=(0,s.a)(),p=[{id:"dashboard",label:"Dashboard",icon:a.Z,path:"/candidate/dashboard"},{id:"practice",label:"Practice Types",icon:l.Z,path:"/candidate/dashboard/practice"},{id:"skills",label:"Skills Map",icon:i.Z,path:"/candidate/dashboard/skills"},{id:"resume",label:"Resume Analysis",icon:u.Z,path:"/candidate/dashboard/resume"},{id:"certificates",label:"Certificates",icon:c.Z,path:"/candidate/dashboard/certificates"},{id:"profile",label:"My Profile",icon:d.Z,path:"/candidate/dashboard/profile"}];return window.location.pathname,(0,n.jsxs)("div",{className:"fixed left-0 top-0 h-screen w-64 bg-gradient-to-b from-purple-600 to-cyan-500 text-white p-6 overflow-y-auto z-40 border-r border-purple-300/20",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-cyan-400 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-white font-bold text-sm",children:"X"})}),(0,n.jsx)("h2",{className:"text-xl font-bold text-white",children:"InterviewX"})]}),(0,n.jsx)("p",{className:"text-xs text-cyan-100 ml-10",children:"Candidate Platform"}),"      "]}),"      ",(0,n.jsx)("nav",{className:"space-y-2",children:p.map(o=>{let r=o.icon,s=t===o.path;return(0,n.jsxs)("button",{onClick:()=>e.push(o.path),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all text-left group\n                ".concat(s?"bg-white/20 text-white font-semibold shadow-md":"text-cyan-100 hover:bg-white/10"),children:[(0,n.jsx)(r,{className:"w-5 h-5 transition-colors ".concat(s?"text-white":"text-cyan-300 group-hover:text-white")}),(0,n.jsx)("span",{className:"font-medium text-sm ".concat(s?"text-white":"text-cyan-100"),children:o.label})]},o.id)})}),(0,n.jsxs)("div",{className:"absolute bottom-6 left-6 right-6 pt-6 border-t border-purple-300/20 space-y-3",children:[(0,n.jsxs)("button",{onClick:()=>{o(),e.push("/")},className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:shadow-lg transition-all duration-200 group font-medium text-sm shadow-md hover:scale-105 active:scale-95",children:[(0,n.jsx)(h.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"Logout"})]}),(0,n.jsx)("p",{className:"text-xs text-cyan-100 text-center",children:"\xa9 2024 InterviewX"})]})]})}},1233:function(e,t,o){o.d(t,{AuthProvider:function(){return l},a:function(){return i}});var n=o(57437),r=o(2265),s=o(2141);let a=(0,r.createContext)();function l(e){let{children:t}=e,[o,l]=(0,r.useState)(null),[i,u]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[m,y]=(0,r.useState)(!1),x=(e,t,o)=>{let n={user:e,session:t,role:o,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(n)),console.log("[Auth] Auth state saved to localStorage")},v=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let o=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=o.user)||void 0===e?void 0:e.email),o}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},w=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,r.useEffect)(()=>{let e=v();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)?(console.log("[Auth] ✅ Restored session from localStorage:",e.user.email),l(e.user),u(e.session),d(e.role),f(!0),y(!0)):console.log("[Auth] ⏳ No cached session, verifying with Supabase...");let t=async()=>{try{let{data:{session:t}}=await s.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] ✅ Valid Supabase session found"),u(t),l(t.user),f(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),x(t.user,t,e.role))}else(null==e?void 0:e.user)||(console.log("[Auth] ❌ No session found anywhere"),u(null),l(null),d(null),f(!1),w());y(!0)}catch(e){console.warn("[Auth] ⚠️ Session verification error:",e.message),y(!0)}};(null==e?void 0:e.user)?t().catch(e=>console.warn("[Auth] Background verification failed:",e)):t();let{data:{subscription:n}}=s.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){console.log("[Auth] Session valid, updating state"),u(t),l(t.user),f(!0);let{data:e}=await s.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),x(t.user,t,e.role))}else if("SIGNED_OUT"===e)console.log("[Auth] User signed out, clearing session"),u(null),l(null),d(null),f(!1),w();else{let e=v();if(null==e?void 0:e.user){var n;console.log("[Auth] Keeping cached session for:",null===(n=e.user)||void 0===n?void 0:n.email),o||(l(e.user),u(e.session),d(e.role),f(!0))}else console.log("[Auth] No current session and no cached session"),f(!1)}});return()=>null==n?void 0:n.unsubscribe()},[]);let S=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let o=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!o.ok){let e=await o.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let n=await o.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:n.user,needsLogin:!0,message:n.message}}catch(e){throw console.error("[Signup] Error:",e),e}},b=async(e,t,o)=>{try{var n,r;console.log("[AuthContext] Attempting login:",{email:e,role:o});let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:o})});if(console.log("[AuthContext] Login response status:",s.status),!s.ok){let e=await s.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let a=await s.json();console.log("[AuthContext] Login successful, setting session"),a.session&&(u(a.session),l(a.session.user||a.user));let i=(null===(n=a.user)||void 0===n?void 0:n.role)||o;return d(i),f(!0),x((null===(r=a.session)||void 0===r?void 0:r.user)||a.user,a.session,i),console.log("[AuthContext] Auth state saved to localStorage"),a.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},k=async()=>{try{await s.OQ.auth.signOut(),u(null),l(null),d(null),f(!1),w(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,n.jsx)(a.Provider,{value:{user:o,session:i,role:c,loading:h,isAuthenticated:g,isHydrated:m,signup:S,login:b,logout:k},children:t})}let i=()=>{let e=(0,r.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},2141:function(e,t,o){o.d(t,{OQ:function(){return i}});var n=o(69066),r=o(40257);let s=r.env.NEXT_PUBLIC_SUPABASE_URL,a=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,l=r.env.SUPABASE_SERVICE_ROLE_KEY,i=null;s&&a&&(i=(0,n.eI)(s,a),(0,n.eI)(s,l||a))},99376:function(e,t,o){var n=o(35475);o.o(n,"useParams")&&o.d(t,{useParams:function(){return n.useParams}}),o.o(n,"usePathname")&&o.d(t,{usePathname:function(){return n.usePathname}}),o.o(n,"useRouter")&&o.d(t,{useRouter:function(){return n.useRouter}}),o.o(n,"useSearchParams")&&o.d(t,{useSearchParams:function(){return n.useSearchParams}})},8301:function(e,t,o){o.d(t,{Z:function(){return a}});var n=o(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var a=(e,t)=>{let o=(0,n.forwardRef)((o,a)=>{let{color:l="currentColor",size:i=24,strokeWidth:u=2,absoluteStrokeWidth:c,children:d,...h}=o;return(0,n.createElement)("svg",{ref:a,...r,width:i,height:i,stroke:l,strokeWidth:c?24*Number(u)/Number(i):u,className:"lucide lucide-".concat(s(e)),...h},[...t.map(e=>{let[t,o]=e;return(0,n.createElement)(t,o)}),...(Array.isArray(d)?d:[d])||[]])});return o.displayName="".concat(e),o}},72643:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},77732:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},6606:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},81359:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},37721:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},46124:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},34906:function(e,t,o){o.d(t,{Z:function(){return n}});let n=(0,o(8301).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])}}]);