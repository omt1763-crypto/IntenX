"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8985],{18985:function(e,t,r){r.d(t,{Z:function(){return j}});var o=r(57437),s=r(27648),n=r(99376),l=r(8301);let a=(0,l.Z)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var i=r(46124),u=r(18512),c=r(78416),d=r(31338),h=r(54891),x=r(50420),g=r(67941),p=r(37701),f=r(72643);let y=(0,l.Z)("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);var v=r(78279),m=r(6606),b=r(1233),w=r(69358);function j(e){let{role:t="company"}=e,r=(0,n.useRouter)(),l=(0,n.usePathname)(),{logout:j}=(0,b.a)(),{isOpen:k,setIsOpen:N}=(0,w.A)(),S=()=>{r.push("/auth/logout")},A="candidate"===t?"/candidate/dashboard":"recruiter"===t?"/recruiter/dashboard":"company"===t?"/business/dashboard":"/dashboard",Z=e=>e===A?l===A:l.startsWith(e),C=[{href:"".concat(A),label:"Dashboard",icon:a},{href:"".concat(A,"/profile"),label:"My Profile",icon:i.Z},{href:"".concat(A,"/jobs"),label:"Jobs",icon:u.Z},{href:"".concat(A,"/billing"),label:"Billing",icon:c.Z},..."candidate"!==t?[{href:"".concat(A,"/applicants"),label:"Applicants",icon:d.Z}]:[{href:"/interview/mock",label:"Mock Interviews",icon:a}]];return(0,o.jsxs)("div",{className:"fixed left-0 top-0 h-screen z-50 bg-gradient-to-b from-blue-600 via-blue-500 to-purple-600 shadow-lg transition-all duration-300 ".concat(k?"w-64":"w-20"," border-r border-blue-400/20"),children:[(0,o.jsxs)("div",{className:"p-6 border-b border-blue-300/20 flex items-center justify-between",children:[k&&(0,o.jsx)("h2",{className:"text-xl font-bold text-white",children:"InterviewX"}),(0,o.jsx)("button",{onClick:()=>N(!k),className:"text-white hover:text-blue-100 transition-colors",children:k?(0,o.jsx)(h.Z,{size:20}):(0,o.jsx)(x.Z,{size:20})})]}),k&&(0,o.jsxs)("div",{className:"px-6 pt-4 pb-8",children:[(0,o.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-400 flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-white font-bold text-sm",children:"X"})})}),(0,o.jsx)("p",{className:"text-xs text-blue-100",children:"AI Interview Platform"})]}),(0,o.jsx)("nav",{className:"px-4 py-2 space-y-2",children:C.map((e,t)=>{let r=e.icon,n=Z(e.href);return(0,o.jsx)(s.default,{href:e.href,children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 cursor-pointer group ".concat(n?"bg-white/20 text-white shadow-lg":"text-blue-100 hover:bg-white/10"),children:[(0,o.jsx)(r,{className:"w-5 h-5 transition-colors ".concat(n?"text-white":"text-blue-200 group-hover:text-white")}),k&&(0,o.jsx)("span",{className:"font-medium transition-colors ".concat(n?"text-white":"group-hover:text-white"),children:e.label})]})},t)})}),k&&window.location.pathname.startsWith("/debug/data")&&(0,o.jsxs)("div",{className:"mt-8 px-4 pt-6 border-t border-blue-300/30",children:[(0,o.jsx)("p",{className:"text-xs font-semibold text-blue-200 uppercase tracking-wider mb-3 px-4",children:"\uD83D\uDD27 Debug Tools"}),(0,o.jsxs)("nav",{className:"space-y-2",children:[(0,o.jsx)(s.default,{href:"/debug/data",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(g.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCCA Overview"})]})}),(0,o.jsx)(s.default,{href:"/debug/data?tab=users",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(p.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDC65 Users"})]})}),(0,o.jsx)(s.default,{href:"/debug/data?tab=jobs",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(u.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCBC Jobs"})]})}),(0,o.jsx)(s.default,{href:"/debug/data?tab=applicants",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(f.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDCDD Applicants"})]})}),(0,o.jsx)(s.default,{href:"/debug/data?tab=interviews",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(y,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83C\uDFA4 Interviews"})]})}),(0,o.jsx)(s.default,{href:"/debug/data?tab=activitylogs",children:(0,o.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg text-xs text-blue-100 hover:bg-white/10 transition-all cursor-pointer group",children:[(0,o.jsx)(v.Z,{className:"w-4 h-4 text-blue-200 group-hover:text-white transition-colors"}),(0,o.jsx)("span",{className:"group-hover:text-white transition-colors",children:"\uD83D\uDEA8 Activity Logs"})]})})]})]}),(0,o.jsxs)("div",{className:"absolute bottom-6 left-4 right-4 pt-6 border-t border-blue-300/20 space-y-2",children:[k&&(0,o.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg p-2.5 shadow-lg",children:(0,o.jsxs)("button",{onClick:S,className:"w-full flex items-center justify-center gap-2 px-3 py-1.5 rounded-lg bg-white/20 text-white hover:bg-white/30 transition-all duration-200 group font-medium text-xs shadow-md hover:shadow-lg hover:scale-105 active:scale-95",children:[(0,o.jsx)(m.Z,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:"Logout"})]})}),!k&&(0,o.jsx)("button",{onClick:S,className:"w-full flex items-center justify-center p-2 rounded-lg bg-red-500/20 text-white hover:bg-red-500/30 transition-all duration-200 group font-medium shadow-md hover:shadow-lg",title:"Logout",children:(0,o.jsx)(m.Z,{className:"w-4 h-4"})}),k&&(0,o.jsx)("p",{className:"text-xs text-blue-100 text-center",children:"\xa9 2024 InterviewX"})]})]})}},1233:function(e,t,r){r.d(t,{AuthProvider:function(){return a},a:function(){return i}});var o=r(57437),s=r(2265),n=r(2141);let l=(0,s.createContext)();function a(e){let{children:t}=e,[r,a]=(0,s.useState)(null),[i,u]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[h,x]=(0,s.useState)(!1),[g,p]=(0,s.useState)(!1),[f,y]=(0,s.useState)(!1),v=(e,t,r)=>{let o={user:e,session:t,role:r,timestamp:new Date().toISOString()};localStorage.setItem("authState",JSON.stringify(o)),console.log("[Auth] Auth state saved to localStorage")},m=()=>{try{let t=localStorage.getItem("authState");if(t){var e;let r=JSON.parse(t);return console.log("[Auth] Loaded auth state from localStorage for:",null===(e=r.user)||void 0===e?void 0:e.email),r}}catch(e){console.error("[Auth] Failed to load auth state:",e)}return null},b=()=>{localStorage.removeItem("authState"),localStorage.removeItem("interviewSetup"),localStorage.removeItem("resumeSkillsSaved"),console.log("[Auth] Auth state cleared from localStorage")};(0,s.useEffect)(()=>{let e=m();(null==e?void 0:e.user)&&(null==e?void 0:e.session)&&(null==e?void 0:e.role)?(console.log("[Auth] ✅ Restored session from localStorage:",e.user.email),a(e.user),u(e.session),d(e.role),p(!0),y(!0)):console.log("[Auth] ⏳ No cached session, verifying with Supabase...");let t=async()=>{try{let{data:{session:t}}=await n.OQ.auth.getSession();if(null==t?void 0:t.user){console.log("[Auth] ✅ Valid Supabase session found"),u(t),a(t.user),p(!0);let{data:e}=await n.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),v(t.user,t,e.role))}else(null==e?void 0:e.user)||(console.log("[Auth] ❌ No session found anywhere"),u(null),a(null),d(null),p(!1),b());y(!0)}catch(e){console.warn("[Auth] ⚠️ Session verification error:",e.message),y(!0)}};(null==e?void 0:e.user)?t().catch(e=>console.warn("[Auth] Background verification failed:",e)):t();let{data:{subscription:o}}=n.OQ.auth.onAuthStateChange(async(e,t)=>{if(console.log("[Auth] Auth state change event:",e),null==t?void 0:t.user){console.log("[Auth] Session valid, updating state"),u(t),a(t.user),p(!0);let{data:e}=await n.OQ.from("users").select("role").eq("id",t.user.id).single();e&&(d(e.role),v(t.user,t,e.role))}else if("SIGNED_OUT"===e)console.log("[Auth] User signed out, clearing session"),u(null),a(null),d(null),p(!1),b();else{let e=m();if(null==e?void 0:e.user){var o;console.log("[Auth] Keeping cached session for:",null===(o=e.user)||void 0===o?void 0:o.email),r||(a(e.user),u(e.session),d(e.role),p(!0))}else console.log("[Auth] No current session and no cached session"),p(!1)}});return()=>null==o?void 0:o.unsubscribe()},[]);let w=async(e,t)=>{try{console.log("[Signup] Attempting signup for:",e.email);let r=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,role:t})});if(!r.ok){let e=await r.json();throw console.error("[Signup] API error:",e),Error(e.error||"Signup failed")}let o=await r.json();return console.log("[Signup] Account created successfully! User must now log in."),{user:o.user,needsLogin:!0,message:o.message}}catch(e){throw console.error("[Signup] Error:",e),e}},j=async(e,t,r)=>{try{var o,s;console.log("[AuthContext] Attempting login:",{email:e,role:r});let n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,role:r})});if(console.log("[AuthContext] Login response status:",n.status),!n.ok){let e=await n.json();throw console.error("[AuthContext] Login error response:",e),Error(e.error||"Login failed")}let l=await n.json();console.log("[AuthContext] Login successful, setting session"),l.session&&(u(l.session),a(l.session.user||l.user));let i=(null===(o=l.user)||void 0===o?void 0:o.role)||r;return d(i),p(!0),v((null===(s=l.session)||void 0===s?void 0:s.user)||l.user,l.session,i),console.log("[AuthContext] Auth state saved to localStorage"),l.user}catch(e){throw console.error("[AuthContext] Login error:",e),e}},k=async()=>{try{await n.OQ.auth.signOut(),u(null),a(null),d(null),p(!1),b(),console.log("[Auth] User logged out, auth state cleared")}catch(e){throw console.error("Logout error:",e),e}};return(0,o.jsx)(l.Provider,{value:{user:r,session:i,role:c,loading:h,isAuthenticated:g,isHydrated:f,signup:w,login:j,logout:k},children:t})}let i=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},69358:function(e,t,r){r.d(t,{A:function(){return a},SidebarProvider:function(){return l}});var o=r(57437),s=r(2265);let n=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,s.useState)(!0);return(0,o.jsx)(n.Provider,{value:{isOpen:r,setIsOpen:l},children:t})}function a(){let e=(0,s.useContext)(n);if(!e)throw Error("useSidebar must be used within SidebarProvider");return e}},2141:function(e,t,r){r.d(t,{OQ:function(){return i}});var o=r(69066),s=r(40257);let n=s.env.NEXT_PUBLIC_SUPABASE_URL,l=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,a=s.env.SUPABASE_SERVICE_ROLE_KEY,i=null;n&&l&&(i=(0,o.eI)(n,l),(0,o.eI)(n,a||l))},78279:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},67941:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},18512:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])},78416:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},72643:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},6606:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},50420:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},46124:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},37701:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("Users2",[["path",{d:"M14 19a6 6 0 0 0-12 0",key:"vej9p1"}],["circle",{cx:"8",cy:"9",r:"4",key:"143rtg"}],["path",{d:"M22 19a6 6 0 0 0-6-6 4 4 0 1 0 0-8",key:"hqbn22"}]])},31338:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},54891:function(e,t,r){r.d(t,{Z:function(){return o}});let o=(0,r(8301).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);